<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Official Schedule and Booking Calendar for NAU MPCT Labs. Reserve equipment, view maintenance windows, and sign up for training.">
    <meta name="theme-color" content="#002454">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Schedule | NAU MPCT Official Calendar</title>

    <!-- 
        ========================================================================
        EXTERNAL RESOURCES
        ========================================================================
        Using Google Fonts to match the NAU Brand:
        - Oswald: For heavy, athletic headings.
        - Source Sans 3: For readable body text and UI elements.
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&family=Source+Sans+3:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,400&display=swap" rel="stylesheet">

    <style>
        /* ========================================================================
        1. DESIGN TOKENS & VARIABLES
        ========================================================================
        
        */
        :root {
            /* BRAND COLORS: CORE */
            --nau-blue: #002454;
            --nau-blue-dark: #001838;
            --nau-blue-light: #003a85;
            --nau-blue-faded: rgba(0, 36, 84, 0.05);
            
            --nau-gold: #FAC01A;
            --nau-gold-dark: #dbb400;
            --nau-gold-light: #fdd054;
            --nau-gold-faded: rgba(250, 192, 26, 0.1);

            /* BRAND COLORS: FUNCTIONAL */
            --nau-green: #007a33;
            --nau-green-light: #e6f2eb;
            --nau-red: #bb0000;
            --nau-red-light: #fcebeb;
            --nau-gray: #58595b;

            /* NEUTRALS */
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --black: #000000;

            /* SEMANTIC COLORS (Event Types) */
            --event-training: var(--nau-green);
            --event-training-bg: var(--nau-green-light);
            --event-maint: var(--nau-red);
            --event-maint-bg: var(--nau-red-light);
            --event-res: var(--nau-blue);
            --event-res-bg: #e0e7ff;
            --event-class: var(--nau-gold);
            --event-class-bg: #fffbeb;

            /* TYPOGRAPHY */
            --font-display: 'Oswald', sans-serif;
            --font-body: 'Source Sans 3', sans-serif;
            
            /* SPACING SYSTEM */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;
            --space-16: 64px;

            /* UI ELEMENTS */
            --radius-sm: 2px;
            --radius-md: 4px;
            --radius-lg: 8px;
            --radius-xl: 12px;
            --radius-full: 9999px;

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);

            --z-header: 100;
            --z-filter: 90;
            --z-modal-backdrop: 200;
            --z-modal: 210;
            --z-tooltip: 300;
        }

        /* ========================================================================
        2. RESET & BASE STYLES
        ========================================================================
        */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
            height: 100%;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--gray-50);
            color: var(--nau-blue);
            line-height: 1.5;
            min-height: 100vh; /* Changed from height: 100% to min-height: 100vh */
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-display);
            text-transform: uppercase;
            font-weight: 700;
            line-height: 1.1;
            letter-spacing: 0.02em;
        }

        a {
            color: inherit;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        button {
            border: none;
            background: none;
            cursor: pointer;
            font-family: inherit;
        }

        ul, ol { list-style: none; }
        
        img { display: block; max-width: 100%; }

        /* ========================================================================
        3. UTILITY CLASSES
        ========================================================================
        */
        .container {
            width: 100%;
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 var(--space-4);
        }

        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .justify-end { justify-content: flex-end; }
        .flex-1 { flex: 1; }
        .gap-1 { gap: var(--space-1); }
        .gap-2 { gap: var(--space-2); }
        .gap-4 { gap: var(--space-4); }

        .grid { display: grid; }
        .hidden { display: none !important; }
        
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-bold { font-weight: 700; }
        .uppercase { text-transform: uppercase; }
        
        .text-gold { color: var(--nau-gold); }
        .text-blue { color: var(--nau-blue); }
        .text-white { color: var(--white); }
        .text-gray { color: var(--gray-500); }
        .text-red { color: var(--nau-red); }
        .text-green { color: var(--nau-green); }

        .bg-white { background-color: var(--white); }
        .bg-blue { background-color: var(--nau-blue); }
        .bg-gray { background-color: var(--gray-100); }

        .p-4 { padding: var(--space-4); }
        .py-2 { padding-top: var(--space-2); padding-bottom: var(--space-2); }
        .px-4 { padding-left: var(--space-4); padding-right: var(--space-4); }
        .mt-4 { margin-top: var(--space-4); }
        .mb-2 { margin-bottom: var(--space-2); }

        /* ========================================================================
        4. COMPONENTS
        ========================================================================
        */
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            font-family: var(--font-display);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.95rem;
            letter-spacing: 0.05em;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
            gap: 8px;
        }

        .btn-lg {
            padding: 14px 28px;
            font-size: 1.1rem;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8rem;
        }

        .btn-primary {
            background-color: var(--nau-gold);
            color: var(--nau-blue);
            border: 2px solid var(--nau-gold);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background-color: var(--white);
            color: var(--nau-blue);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background-color: var(--nau-blue);
            color: var(--white);
            border: 2px solid var(--nau-blue);
        }

        .btn-secondary:hover {
            background-color: var(--nau-blue-light);
            border-color: var(--nau-blue-light);
            transform: translateY(-1px);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--nau-blue);
            border: 2px solid var(--gray-300);
        }

        .btn-outline:hover {
            border-color: var(--nau-blue);
            background-color: var(--nau-blue-faded);
        }
        
        .btn-icon {
            padding: 8px;
            border-radius: 50%;
            color: var(--gray-600);
        }
        
        .btn-icon:hover {
            background-color: var(--gray-200);
            color: var(--nau-blue);
        }

        /* Inputs */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 16px;
        }

        .input-label {
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--gray-700);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-family: var(--font-body);
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--nau-blue);
            box-shadow: 0 0 0 3px var(--nau-blue-faded);
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
        }

        /* Badges */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: var(--radius-md);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            line-height: 1.2;
        }

        .badge-blue { background: var(--event-res-bg); color: var(--nau-blue); }
        .badge-green { background: var(--event-training-bg); color: var(--nau-green); }
        .badge-red { background: var(--event-maint-bg); color: var(--nau-red); }
        .badge-gold { background: var(--event-class-bg); color: #92400e; }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
        }

        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.1rem;
            margin: 0;
            color: var(--nau-blue);
        }

        .card-body {
            padding: 20px;
        }

        /* ========================================================================
        5. LAYOUT STRUCTURE
        ========================================================================
        */
        
        /* Header */
        .app-header {
            background-color: var(--nau-blue);
            color: var(--white);
            position: sticky;
            top: 0;
            z-index: var(--z-header);
            box-shadow: var(--shadow-md);
            height: 70px;
        }

        .header-content {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .brand-lockup {
            display: flex;
            align-items: center;
            gap: 16px;
            text-decoration: none;
            color: var(--white);
        }

        .brand-logo {
            height: 48px;
            width: auto;
            filter: brightness(0) invert(1);
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            line-height: 1;
        }

        .brand-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        .brand-subtitle {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--nau-gold);
            font-weight: 600;
            letter-spacing: 0.1em;
        }

        .main-nav {
            display: flex;
            gap: 4px;
        }

        .nav-item {
            padding: 8px 16px;
            font-family: var(--font-display);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.95rem;
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.8);
        }

        .nav-item:hover, .nav-item.active {
            color: var(--white);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            box-shadow: inset 0 -2px 0 var(--nau-gold);
            border-radius: 4px 4px 0 0;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            color: rgba(255,255,255,0.8);
        }
        
        .notification-bell:hover { color: var(--nau-gold); }

        .badge-dot {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            background-color: var(--nau-red);
            border-radius: 50%;
            border: 2px solid var(--nau-blue);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--nau-gold);
            color: var(--nau-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-family: var(--font-display);
            border: 2px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }

        /* Hero Bar */
        .hero-bar {
            background: linear-gradient(rgba(0,36,84,0.9), rgba(0,36,84,0.8)), url('https://images.unsplash.com/photo-1555664424-778a69032054?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            padding: 30px 0;
            color: var(--white);
            border-bottom: 4px solid var(--nau-gold);
        }

        .hero-content h1 {
            font-size: 2.5rem;
            margin-bottom: 8px;
            font-style: italic;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.3);
        }
        
        .hero-stats {
            display: flex;
            gap: 32px;
            margin-top: 20px;
        }
        
        .hero-stat {
            display: flex;
            flex-direction: column;
            border-left: 2px solid var(--nau-gold);
            padding-left: 12px;
        }
        
        .stat-val { font-family: var(--font-display); font-size: 1.5rem; font-weight: 700; line-height: 1; }
        .stat-lbl { font-size: 0.75rem; opacity: 0.8; text-transform: uppercase; }

        /* App Layout */
        .app-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 24px;
            padding: 24px 0;
            flex: 1; /* Pushes footer down naturally */
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
            /* Sticky Positioning */
            position: sticky;
            top: 90px; /* Below Header */
            height: fit-content;
        }

        .sidebar-section {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .sidebar-title {
            font-size: 0.95rem;
            color: var(--nau-blue);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--nau-gold);
            display: flex;
            justify-content: space-between;
        }

        .mini-calendar {
            /* Simplified grid styles for mini calendar */
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            text-align: center;
            font-size: 0.8rem;
        }
        
        .mini-cal-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .mini-cal-day:hover { background-color: var(--gray-100); }
        .mini-cal-day.active { background-color: var(--nau-blue); color: var(--white); }
        .mini-cal-day.muted { color: var(--gray-400); }

        .filter-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: var(--radius-md);
            transition: background 0.2s;
        }

        .filter-checkbox:hover { background-color: var(--gray-50); }

        .checkbox-custom {
            width: 18px;
            height: 18px;
            border: 2px solid var(--gray-300);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .filter-checkbox.checked .checkbox-custom {
            background-color: var(--nau-blue);
            border-color: var(--nau-blue);
        }
        
        .checkbox-custom svg { width: 12px; height: 12px; stroke: var(--white); stroke-width: 3; display: none; }
        .filter-checkbox.checked .checkbox-custom svg { display: block; }
        
        .filter-label { font-size: 0.9rem; font-weight: 500; color: var(--gray-700); flex: 1; }
        .filter-count { font-size: 0.75rem; color: var(--gray-500); background: var(--gray-100); padding: 2px 6px; border-radius: 10px; }

        /* Main Calendar Area */
        .calendar-container {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 800px; /* Fixed viewport to keep "App" feel within the page */
        }

        /* Toolbar */
        .cal-toolbar {
            padding: 16px 24px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--white);
        }

        .cal-nav {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .cal-title {
            font-size: 1.5rem;
            color: var(--nau-blue);
            min-width: 220px;
        }

        .nav-buttons {
            display: flex;
            background: var(--gray-100);
            padding: 4px;
            border-radius: var(--radius-md);
        }

        .nav-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            color: var(--gray-600);
        }
        
        .nav-btn:hover { background-color: var(--white); color: var(--nau-blue); box-shadow: var(--shadow-sm); }

        .view-switcher {
            display: flex;
            background: var(--gray-100);
            padding: 4px;
            border-radius: var(--radius-md);
        }

        .view-btn {
            padding: 6px 16px;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--gray-600);
            border-radius: var(--radius-sm);
        }

        .view-btn.active {
            background-color: var(--white);
            color: var(--nau-blue);
            box-shadow: var(--shadow-sm);
        }

        /* Calendar Views */
        .view-content {
            flex: 1;
            overflow-y: auto;
            position: relative;
        }

        /* Month View Grid */
        .month-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: 40px repeat(5, minmax(120px, 1fr));
            border-left: 1px solid var(--gray-200);
            border-top: 1px solid var(--gray-200);
        }

        .grid-header {
            background-color: var(--gray-50);
            color: var(--gray-600);
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid var(--gray-200);
            border-bottom: 1px solid var(--gray-200);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .day-cell {
            border-right: 1px solid var(--gray-200);
            border-bottom: 1px solid var(--gray-200);
            background-color: var(--white);
            padding: 4px;
            position: relative;
            transition: background 0.2s;
        }
        
        .day-cell:hover { background-color: var(--gray-50); }
        .day-cell.other-month { background-color: var(--gray-50); opacity: 0.7; }
        .day-cell.today { background-color: rgba(250, 192, 26, 0.05); }

        .date-label {
            display: block;
            text-align: right;
            font-size: 0.85rem;
            font-weight: 600;
            padding: 4px 8px;
            color: var(--gray-600);
        }
        
        .day-cell.today .date-label {
            color: var(--nau-blue);
            font-weight: 800;
        }
        
        .day-cell.today .date-label::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            background: var(--nau-gold);
            border-radius: 50%;
            margin-right: 4px;
            margin-bottom: 2px;
        }

        .events-stack {
            display: flex;
            flex-direction: column;
            gap: 2px;
            overflow: hidden;
        }

        .event-chip {
            font-size: 0.75rem;
            padding: 3px 6px;
            border-radius: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
            border-left: 3px solid transparent;
            font-weight: 600;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        .event-chip:hover {
            transform: translateX(1px) scale(1.02);
            box-shadow: var(--shadow-sm);
            z-index: 5;
        }

        /* Theme Variants for Events */
        .chip-res { background-color: var(--event-res-bg); color: var(--nau-blue); border-left-color: var(--nau-blue); }
        .chip-maint { background-color: var(--event-maint-bg); color: var(--nau-red); border-left-color: var(--nau-red); }
        .chip-train { background-color: var(--event-training-bg); color: var(--nau-green); border-left-color: var(--nau-green); }
        .chip-class { background-color: var(--event-class-bg); color: #92400e; border-left-color: var(--nau-gold); }

        /* Week/Day View (Time Grid) */
        .time-grid {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr); /* 60px time column */
            overflow-y: auto;
        }
        
        .time-col {
            border-right: 1px solid var(--gray-200);
            text-align: right;
            font-size: 0.75rem;
            color: var(--gray-500);
            transform: translateY(-8px);
        }
        
        .time-slot {
            height: 50px; /* 1 hour height */
            border-bottom: 1px solid var(--gray-100);
            padding-right: 8px;
        }

        .day-col {
            border-right: 1px solid var(--gray-200);
            position: relative;
            background: 
                repeating-linear-gradient(to bottom, transparent, transparent 49px, var(--gray-100) 50px);
            background-size: 100% 50px; /* Matches time slot height */
        }
        
        .time-event {
            position: absolute;
            left: 2px;
            right: 2px;
            border-radius: 4px;
            padding: 4px 6px;
            font-size: 0.75rem;
            border: 1px solid rgba(0,0,0,0.1);
            overflow: hidden;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
        }
        
        .time-event .evt-title { font-weight: 700; display: block; margin-bottom: 2px; }
        .time-event .evt-time { font-size: 0.7rem; opacity: 0.8; }

        /* ========================================================================
        6. MODALS & OVERLAYS
        ========================================================================
        */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 36, 84, 0.6);
            backdrop-filter: blur(4px);
            z-index: var(--z-modal-backdrop);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-backdrop.open {
            opacity: 1;
            pointer-events: auto;
        }

        .modal {
            background: var(--white);
            width: 100%;
            max-width: 700px;
            max-height: 90vh;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            transform: translateY(20px);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            border-top: 6px solid var(--nau-gold);
            overflow: hidden;
        }

        .modal-backdrop.open .modal { transform: translateY(0); }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title { font-size: 1.5rem; color: var(--nau-blue); margin: 0; }
        .modal-close { font-size: 1.5rem; color: var(--gray-400); transition: color 0.2s; }
        .modal-close:hover { color: var(--nau-red); }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 16px 24px;
            background-color: var(--gray-50);
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Booking Form Steps */
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
            position: relative;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gray-200);
            z-index: 1;
            transform: translateY(-50%);
        }

        .step {
            position: relative;
            z-index: 2;
            background: var(--white);
            padding: 0 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--gray-400);
        }

        .step-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--gray-100);
            border: 2px solid var(--gray-300);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--gray-500);
            font-family: var(--font-display);
        }

        .step.active .step-circle {
            background: var(--nau-gold);
            border-color: var(--nau-gold);
            color: var(--nau-blue);
        }
        
        .step.active { color: var(--nau-blue); }
        .step.completed .step-circle { background: var(--nau-green); border-color: var(--nau-green); color: white; }

        /* Time Slot Grid */
        .slots-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .time-btn {
            border: 1px solid var(--gray-300);
            padding: 10px;
            border-radius: var(--radius-md);
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .time-btn:hover { border-color: var(--nau-blue); color: var(--nau-blue); }
        .time-btn.selected { background-color: var(--nau-blue); color: white; border-color: var(--nau-blue); }
        .time-btn.disabled { opacity: 0.4; cursor: not-allowed; background-color: var(--gray-100); text-decoration: line-through; }

        /* Equipment List (Radio Cards) */
        .equip-option {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-md);
            cursor: pointer;
            margin-bottom: 8px;
            transition: 0.2s;
        }

        .equip-option:hover { border-color: var(--nau-blue); background-color: var(--gray-50); }
        .equip-option.selected { border-color: var(--nau-gold); background-color: rgba(250, 192, 26, 0.05); box-shadow: 0 0 0 1px var(--nau-gold); }

        .equip-img { width: 50px; height: 50px; background: var(--gray-200); border-radius: 4px; object-fit: cover; }
        .equip-info { flex: 1; }
        .equip-name { font-weight: 700; display: block; }
        .equip-status { font-size: 0.75rem; color: var(--nau-green); }

        /* Footer */
        .app-footer {
            background-color: var(--nau-blue);
            color: var(--white);
            padding: 60px 0 20px;
            margin-top: auto;
            position: relative; /* Ensure it layers correctly */
            z-index: 10;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-brand p {
            color: rgba(255,255,255,0.7);
            max-width: 300px;
            margin-top: 16px;
            font-size: 0.9rem;
        }

        .footer-col h4 {
            color: var(--nau-gold);
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .footer-links li { margin-bottom: 10px; }
        .footer-links a { color: rgba(255,255,255,0.7); font-size: 0.9rem; }
        .footer-links a:hover { color: var(--white); text-decoration: underline; }

        /* ========================================================================
        7. RESPONSIVE DESIGN
        ========================================================================
        */
        @media (max-width: 1024px) {
            .app-layout { grid-template-columns: 1fr; }
            .sidebar { display: none; } /* In real app, move to drawer */
            .month-grid { grid-template-rows: 40px repeat(5, minmax(80px, 1fr)); }
            .date-label { font-size: 0.75rem; }
            .event-chip { font-size: 0.65rem; padding: 2px 4px; }
        }

        @media (max-width: 768px) {
            .app-header .brand-text { display: none; }
            .hero-stats { display: none; }
            .month-grid { display: none; }
            .calendar-container { height: auto; min-height: 500px; }
            /* Force list view on mobile via JS logic later */
            .slots-grid { grid-template-columns: repeat(2, 1fr); }
            .footer-grid { grid-template-columns: 1fr; gap: 24px; }
        }
    </style>
</head>
<body>

    <!-- 
    ========================================================================
    HEADER
    ========================================================================
    -->
    <header class="app-header">
        <div class="container header-content">
            <a href="Athletics_style1.html" class="brand-lockup">
                <div class="brand-text">
                    <span class="brand-title">NAU MPCT</span>
                    <span class="brand-subtitle">Lab Operations</span>
                </div>
            </a>

            <nav class="main-nav">
                <a href="Athletics_style1.html" class="nav-item">Home</a>
                <a href="calendar.html" class="nav-item active">Calendar</a>
                <a href="#" class="nav-item">Faculty</a>
                <a href="#" class="nav-item">Login</a>
            </nav>

            <div class="user-menu">
                <div class="notification-bell" title="Notifications">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <div class="badge-dot"></div>
                </div>
                <div class="user-avatar" title="Dr. A">A</div>
            </div>
        </div>
    </header>

    <!-- 
    ========================================================================
    HERO / CONTEXT BAR
    ========================================================================
    -->
    <section class="hero-bar">
        <div class="container">
            <div class="flex justify-between items-end">
                <div class="hero-content">
                    <h5>Academic Year 2025-2026</h5>
                    <h1>Master Schedule</h1>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="stat-val text-gold">94%</span>
                            <span class="stat-lbl">Equip Uptime</span>
                        </div>
                        <div class="hero-stat">
                            <span class="stat-val text-white">12</span>
                            <span class="stat-lbl">Active Classes</span>
                        </div>
                        <div class="hero-stat">
                            <span class="stat-val text-green">Open</span>
                            <span class="stat-lbl">Cleanroom Status</span>
                        </div>
                    </div>
                </div>
                <div>
                    <button class="btn btn-primary btn-lg" onclick="app.openModal('booking')">
                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg>
                        Reserve Equipment
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- 
    ========================================================================
    MAIN APPLICATION LAYOUT
    ========================================================================
    -->
    <div class="container app-layout" id="app-root">
        
        <!-- SIDEBAR (FILTERS & DASHBOARD) -->
        <aside class="sidebar">
            <!-- Mini Calendar -->
            <div class="sidebar-section">
                <div class="sidebar-title">
                    <span>Quick Jump</span>
                </div>
                <div style="text-align:center; font-weight:700; margin-bottom:8px;">January 2026</div>
                <div class="mini-calendar" id="miniCal">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Filters -->
            <div class="sidebar-section">
                <div class="sidebar-title">
                    <span>Lab Areas</span>
                    <button class="text-blue" style="font-size:0.7rem; font-weight:700;" onclick="app.resetFilters()">RESET</button>
                </div>
                <div class="filter-list" id="areaFilters">
                    <!-- Checkboxes -->
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span>Event Type</span></div>
                <div class="filter-list" id="typeFilters">
                    <!-- Checkboxes -->
                </div>
            </div>

            <!-- Legend -->
            <div class="sidebar-section">
                <div class="sidebar-title"><span>Legend</span></div>
                <div class="flex flex-col gap-2" style="font-size:0.8rem;">
                    <div class="flex items-center gap-2"><span class="badge badge-blue" style="width:10px; height:10px; padding:0;"></span> Reservation</div>
                    <div class="flex items-center gap-2"><span class="badge badge-red" style="width:10px; height:10px; padding:0;"></span> Maintenance</div>
                    <div class="flex items-center gap-2"><span class="badge badge-green" style="width:10px; height:10px; padding:0;"></span> Training</div>
                    <div class="flex items-center gap-2"><span class="badge badge-gold" style="width:10px; height:10px; padding:0;"></span> Class/Lecture</div>
                </div>
            </div>
        </aside>

        <!-- MAIN CALENDAR CONTAINER -->
        <main class="calendar-container">
            <!-- Toolbar -->
            <div class="cal-toolbar">
                <div class="cal-nav">
                    <div class="nav-buttons">
                        <button class="nav-btn" onclick="app.prevMonth()">
                            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
                        </button>
                        <button class="nav-btn" onclick="app.nextMonth()">
                            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 18l6-6-6-6"/></svg>
                        </button>
                    </div>
                    <h2 class="cal-title" id="currentMonthDisplay">January 2026</h2>
                    <button class="btn btn-outline btn-sm" onclick="app.goToToday()">Today</button>
                </div>

                <div class="view-switcher">
                    <button class="view-btn active" data-view="month" onclick="app.changeView('month')">Month</button>
                    <button class="view-btn" data-view="week" onclick="app.changeView('week')">Week</button>
                    <button class="view-btn" data-view="day" onclick="app.changeView('day')">Day</button>
                    <button class="view-btn" data-view="agenda" onclick="app.changeView('agenda')">Agenda</button>
                </div>
            </div>

            <!-- View Render Area -->
            <div class="view-content" id="calendarView">
                <!-- Content injected via JS -->
            </div>
        </main>
    </div>

    <!-- 
    ========================================================================
    FOOTER
    ========================================================================
    -->
    <footer class="app-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Northern_Arizona_Lumberjacks_logo.svg/1200px-Northern_Arizona_Lumberjacks_logo.svg.png" style="filter: brightness(0) invert(1); height:40px;" alt="NAU Logo">
                    <p>The MPCT Lab is the premier semiconductor research facility in Northern Arizona, empowering the next generation of engineers.</p>
                </div>
                <div class="footer-col">
                    <h4>Operations</h4>
                    <ul class="footer-links">
                        <li><a href="#">Equipment Status</a></li>
                        <li><a href="#">Safety Protocols</a></li>
                        <li><a href="#">Report an Issue</a></li>
                        <li><a href="#">Supply Request</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Training</h4>
                    <ul class="footer-links">
                        <li><a href="#">Certification Path</a></li>
                        <li><a href="#">Video Library</a></li>
                        <li><a href="#">Standard Recipes</a></li>
                        <li><a href="#">Wiki</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contact</h4>
                    <ul class="footer-links">
                        <li><a href="#">Lab Manager</a></li>
                        <li><a href="#">Faculty Directory</a></li>
                        <li><a href="#">Emergency: 911</a></li>
                        <li><a href="#">Campus Security</a></li>
                    </ul>
                </div>
            </div>
            <div class="text-center" style="border-top:1px solid rgba(255,255,255,0.1); padding-top:20px; font-size:0.85rem; color:rgba(255,255,255,0.5);">
                &copy; 2026 Northern Arizona University. All Rights Reserved. Go Jacks!
            </div>
        </div>
    </footer>

    <!-- 
    ========================================================================
    MODALS
    ========================================================================
    -->

    <!-- Booking Modal -->
    <div class="modal-backdrop" id="bookingModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">New Reservation</h3>
                <button class="modal-close" onclick="app.closeModal('booking')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Progress Steps -->
                <div class="step-indicator">
                    <div class="step active" id="step1-ind">
                        <div class="step-circle">1</div>
                        <span>Equipment</span>
                    </div>
                    <div class="step" id="step2-ind">
                        <div class="step-circle">2</div>
                        <span>Time</span>
                    </div>
                    <div class="step" id="step3-ind">
                        <div class="step-circle">3</div>
                        <span>Confirm</span>
                    </div>
                </div>

                <!-- Step 1: Equipment Selection -->
                <div id="step1" class="step-content">
                    <div class="input-group">
                        <label class="input-label">Filter Category</label>
                        <div class="flex gap-2">
                            <button class="btn btn-sm btn-secondary">All</button>
                            <button class="btn btn-sm btn-outline">Lithography</button>
                            <button class="btn btn-sm btn-outline">Metrology</button>
                            <button class="btn btn-sm btn-outline">Etch</button>
                        </div>
                    </div>
                    <div style="height: 300px; overflow-y: auto;">
                        <div class="equip-option selected" onclick="app.selectEquip(this)">
                            <img src="https://images.unsplash.com/photo-1581093588402-4858642d5502?w=100&q=80" class="equip-img" alt="Eq">
                            <div class="equip-info">
                                <span class="equip-name">Karl Suss MA6 (Mask Aligner)</span>
                                <span class="equip-status">Available • Cleanroom Bay 1</span>
                            </div>
                            <div class="badge badge-green">Good</div>
                        </div>
                        <div class="equip-option" onclick="app.selectEquip(this)">
                            <img src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=100&q=80" class="equip-img" alt="Eq">
                            <div class="equip-info">
                                <span class="equip-name">Zeiss Sigma 300 (SEM)</span>
                                <span class="equip-status">Available • Metrology Lab</span>
                            </div>
                            <div class="badge badge-green">Good</div>
                        </div>
                        <div class="equip-option" onclick="app.selectEquip(this)">
                            <img src="https://images.unsplash.com/photo-1517420704952-d9f39714cdd1?w=100&q=80" class="equip-img" alt="Eq">
                            <div class="equip-info">
                                <span class="equip-name">Oxford PlasmaPro (RIE)</span>
                                <span class="equip-status text-red">Maintenance Required</span>
                            </div>
                            <div class="badge badge-red">Offline</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Time Selection -->
                <div id="step2" class="step-content hidden">
                    <div class="input-group">
                        <label class="input-label">Date</label>
                        <input type="date" class="form-control" id="bookingDateInput">
                    </div>
                    <label class="input-label mb-2">Available Slots (1 Hour Blocks)</label>
                    <div class="slots-grid" id="timeSlotsGrid">
                        <!-- Populated via JS -->
                    </div>
                </div>

                <!-- Step 3: Confirmation -->
                <div id="step3" class="step-content hidden">
                    <div class="card bg-gray p-4 mb-2">
                        <h4 class="text-blue mb-2">Reservation Summary</h4>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray font-bold">Equipment:</span>
                            <span>Karl Suss MA6</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray font-bold">Date:</span>
                            <span id="confirmDate">Jan 15, 2026</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="text-gray font-bold">Time:</span>
                            <span id="confirmTime">10:00 AM - 11:00 AM</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Project / Course Code</label>
                        <input type="text" class="form-control" placeholder="e.g. EE490-Capstone">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Notes</label>
                        <textarea class="form-control" rows="2" placeholder="Standard process..."></textarea>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="app.prevStep()" id="btnBack" style="display:none;">Back</button>
                <div class="flex-1"></div>
                <button class="btn btn-primary" onclick="app.nextStep()" id="btnNext">Next Step</button>
            </div>
        </div>
    </div>

    <!-- 
    ========================================================================
    JAVASCRIPT LOGIC (SPA Architecture)
    ========================================================================
    -->
    <script>
        /**
         * MPCT Calendar Application
         * Handles State, Views, and Mock Data
         */
        
        class CalendarApp {
            constructor() {
                // State
                this.currentDate = new Date(2026, 0, 15); // Start mid-Jan 2026
                this.currentView = 'month';
                this.events = [];
                this.filters = {
                    areas: ['Cleanroom', 'Metrology', 'Packaging', 'Classroom'],
                    types: ['Reservation', 'Maintenance', 'Training', 'Class']
                };
                this.currentBookingStep = 1;
                this.selectedEquip = null;
                this.selectedTime = null;

                // DOM Elements
                this.elView = document.getElementById('calendarView');
                this.elTitle = document.getElementById('currentMonthDisplay');
                this.elMiniCal = document.getElementById('miniCal');
                
                // Initialize
                this.generateMockEvents();
                this.initFilters();
                this.render();
                this.renderMiniCal();
            }

            // --- DATA GENERATION ---
            generateMockEvents() {
                const types = ['Reservation', 'Maintenance', 'Training', 'Class'];
                const areas = ['Cleanroom', 'Metrology', 'Packaging', 'Classroom'];
                const titles = [
                    ['Mask Aligner', 'SEM Session', 'Sputter Deposition', 'DRIE Etch'],
                    ['Pump Service', 'Filament Change', 'Calibration', 'Software Update'],
                    ['Litho Basic', 'SEM Safety', 'Wet Bench Cert', 'Laser Cutter'],
                    ['EE490 Lab', 'EE380 Intro', 'Grad Research', 'Industry Tour']
                ];

                // Generate 200 random events around the current date
                for (let i = 0; i < 200; i++) {
                    const typeIdx = Math.floor(Math.random() * 4);
                    const type = types[typeIdx];
                    
                    // Random date within +/- 45 days
                    const dayOffset = Math.floor(Math.random() * 90) - 45;
                    const date = new Date(this.currentDate);
                    date.setDate(date.getDate() + dayOffset);
                    
                    // Random Time (8am to 6pm)
                    const hour = 8 + Math.floor(Math.random() * 10);
                    date.setHours(hour, 0, 0, 0);

                    const evt = {
                        id: i,
                        title: titles[typeIdx][Math.floor(Math.random() * 4)],
                        date: date,
                        type: type,
                        area: areas[Math.floor(Math.random() * areas.length)],
                        duration: 1 + Math.floor(Math.random() * 2) // 1-3 hours
                    };
                    this.events.push(evt);
                }
            }

            // --- RENDERING CORE ---
            render() {
                // Update Title
                const options = { month: 'long', year: 'numeric' };
                this.elTitle.innerText = this.currentDate.toLocaleDateString('en-US', options);

                // Update Active View Buttons
                document.querySelectorAll('.view-btn').forEach(b => {
                    b.classList.toggle('active', b.dataset.view === this.currentView);
                });

                // Clear Content
                this.elView.innerHTML = '';

                // Route to View Renderer
                switch(this.currentView) {
                    case 'month': this.renderMonthView(); break;
                    case 'week': this.renderWeekView(); break;
                    case 'day': this.renderDayView(); break;
                    case 'agenda': this.renderAgendaView(); break;
                }
            }

            getFilteredEvents() {
                return this.events.filter(e => 
                    this.filters.types.includes(e.type) &&
                    this.filters.areas.includes(e.area)
                );
            }

            // --- VIEW RENDERERS ---

            renderMonthView() {
                // Generate Grid HTML
                let html = `<div class="month-grid">`;
                
                // Headers
                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                days.forEach(d => html += `<div class="grid-header">${d}</div>`);

                // Calculate Days
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDay = firstDay.getDay(); // 0-6
                const totalDays = lastDay.getDate();

                // Previous Month Filler
                const prevMonthLastDay = new Date(year, month, 0).getDate();
                for (let i = 0; i < startDay; i++) {
                    html += `<div class="day-cell other-month"><span class="date-label">${prevMonthLastDay - startDay + 1 + i}</span></div>`;
                }

                // Current Month
                const events = this.getFilteredEvents();
                const todayStr = new Date().toDateString();

                for (let i = 1; i <= totalDays; i++) {
                    const currentDayStr = new Date(year, month, i).toDateString();
                    const isToday = currentDayStr === todayStr ? 'today' : '';
                    
                    // Filter events for this day
                    const dayEvents = events.filter(e => 
                        e.date.getDate() === i && 
                        e.date.getMonth() === month && 
                        e.date.getFullYear() === year
                    );

                    html += `<div class="day-cell ${isToday}">
                        <span class="date-label">${i}</span>
                        <div class="events-stack">`;
                    
                    // Render max 3 events, then +x more
                    dayEvents.slice(0, 4).forEach(e => {
                        let cls = 'chip-res';
                        if(e.type === 'Maintenance') cls = 'chip-maint';
                        if(e.type === 'Training') cls = 'chip-train';
                        if(e.type === 'Class') cls = 'chip-class';
                        
                        html += `<div class="event-chip ${cls}" title="${e.title} (${e.time})">${e.title}</div>`;
                    });

                    if(dayEvents.length > 4) {
                        html += `<div style="font-size:0.7rem; color:var(--gray-500); padding-left:4px;">+${dayEvents.length - 4} more</div>`;
                    }

                    html += `</div></div>`;
                }

                // Next Month Filler (to complete grid)
                // Simplified for brevity, usually calculate remaining cells
                
                html += `</div>`;
                this.elView.innerHTML = html;
            }

            renderWeekView() {
                // Simplified vertical time grid
                let html = `<div class="time-grid">`;
                
                // Time Column
                html += `<div style="border-right:1px solid var(--gray-200);">
                    <div style="height:40px; border-bottom:1px solid var(--gray-200);"></div>`; // Corner
                for(let h=8; h<=18; h++) {
                    const ampm = h >= 12 ? 'PM' : 'AM';
                    const hour = h > 12 ? h - 12 : h;
                    html += `<div class="time-slot"><div class="time-col">${hour} ${ampm}</div></div>`;
                }
                html += `</div>`;

                // Days Columns
                const curr = new Date(this.currentDate);
                const day = curr.getDay(); 
                // Set to sunday
                curr.setDate(curr.getDate() - day);

                const events = this.getFilteredEvents();

                for(let i=0; i<7; i++) {
                    const d = new Date(curr);
                    const dayNum = d.getDate();
                    const dayName = d.toLocaleDateString('en-US', {weekday:'short'});
                    
                    html += `<div class="day-col">
                        <div class="grid-header" style="position:static;">${dayName} ${dayNum}</div>`;
                    
                    // Render events absolutely positioned
                    const dayEvents = events.filter(e => e.date.toDateString() === d.toDateString());
                    
                    dayEvents.forEach(e => {
                        const startHour = e.date.getHours();
                        if(startHour >= 8 && startHour <= 18) {
                            const top = (startHour - 8) * 50; // 50px per hour
                            const height = e.duration * 50;
                            
                            let bg = '#e0e7ff'; let border = 'var(--nau-blue)';
                            if(e.type === 'Maintenance') { bg = '#fcebeb'; border = 'var(--nau-red)'; }
                            
                            html += `<div class="time-event" style="top:${top}px; height:${height}px; background:${bg}; border-left:3px solid ${border};">
                                <span class="evt-title">${e.title}</span>
                                <span class="evt-time">${startHour}:00 - ${startHour+e.duration}:00</span>
                            </div>`;
                        }
                    });
                    
                    html += `</div>`;
                    curr.setDate(curr.getDate() + 1);
                }

                html += `</div>`;
                this.elView.innerHTML = html;
            }

            // --- NAVIGATION ---
            prevMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                this.render();
                this.renderMiniCal();
            }

            nextMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                this.render();
                this.renderMiniCal();
            }

            goToToday() {
                this.currentDate = new Date();
                this.render();
                this.renderMiniCal();
            }

            changeView(view) {
                this.currentView = view;
                this.render();
            }

            // --- FILTERS UI ---
            initFilters() {
                const areaContainer = document.getElementById('areaFilters');
                const typeContainer = document.getElementById('typeFilters');

                const renderCheck = (lbl, group) => {
                    return `<div class="filter-checkbox checked" onclick="app.toggleFilter(this, '${group}', '${lbl}')">
                        <div class="checkbox-custom"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                        <span class="filter-label">${lbl}</span>
                    </div>`;
                };

                this.filters.areas.forEach(a => areaContainer.innerHTML += renderCheck(a, 'areas'));
                this.filters.types.forEach(t => typeContainer.innerHTML += renderCheck(t, 'types'));
            }

            toggleFilter(el, group, value) {
                el.classList.toggle('checked');
                const index = this.filters[group].indexOf(value);
                if (index > -1) {
                    this.filters[group].splice(index, 1);
                } else {
                    this.filters[group].push(value);
                }
                this.render();
            }

            resetFilters() {
                // Implementation for resetting arrays and UI
                this.filters.areas = ['Cleanroom', 'Metrology', 'Packaging', 'Classroom'];
                document.querySelectorAll('#areaFilters .filter-checkbox').forEach(c => c.classList.add('checked'));
                this.render();
            }

            // --- MINI CAL ---
            renderMiniCal() {
                // Simplified render for sidebar
                // In a full app, this duplicates grid logic but creates smaller elements
                let html = '';
                for(let i=1; i<=31; i++) {
                    const active = (i === this.currentDate.getDate()) ? 'active' : '';
                    html += `<div class="mini-cal-day ${active}" onclick="app.setDate(${i})">${i}</div>`;
                }
                this.elMiniCal.innerHTML = html;
            }
            
            setDate(day) {
                this.currentDate.setDate(day);
                this.render();
                this.renderMiniCal(); // Update active state
            }

            // --- MODAL LOGIC ---
            openModal(id) {
                document.getElementById(id + 'Modal').classList.add('open');
                this.resetBooking();
            }

            closeModal(id) {
                document.getElementById(id + 'Modal').classList.remove('open');
            }

            // Booking Flow
            resetBooking() {
                this.currentBookingStep = 1;
                this.updateBookingUI();
            }

            selectEquip(el) {
                document.querySelectorAll('.equip-option').forEach(e => e.classList.remove('selected'));
                el.classList.add('selected');
                this.selectedEquip = el.querySelector('.equip-name').innerText;
            }

            nextStep() {
                if (this.currentBookingStep === 1) {
                    if(!this.selectedEquip) { alert("Please select equipment"); return; }
                    this.generateTimeSlots();
                    // Set Date input to today formatted
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('bookingDateInput').value = today;
                }
                if (this.currentBookingStep === 2) {
                    // Validation for time
                }
                if (this.currentBookingStep === 3) {
                    alert("Reservation Confirmed!");
                    this.closeModal('booking');
                    return;
                }

                this.currentBookingStep++;
                this.updateBookingUI();
            }

            prevStep() {
                this.currentBookingStep--;
                this.updateBookingUI();
            }

            updateBookingUI() {
                // Update Indicators
                document.querySelectorAll('.step').forEach((s, idx) => {
                    s.classList.toggle('active', idx + 1 === this.currentBookingStep);
                    s.classList.toggle('completed', idx + 1 < this.currentBookingStep);
                });

                // Show Content
                document.querySelectorAll('.step-content').forEach(c => c.classList.add('hidden'));
                document.getElementById('step' + this.currentBookingStep).classList.remove('hidden');

                // Update Buttons
                const nextBtn = document.getElementById('btnNext');
                const backBtn = document.getElementById('btnBack');
                
                backBtn.style.display = this.currentBookingStep === 1 ? 'none' : 'block';
                nextBtn.innerText = this.currentBookingStep === 3 ? 'Confirm Booking' : 'Next Step';
            }

            generateTimeSlots() {
                const container = document.getElementById('timeSlotsGrid');
                let html = '';
                const times = ['8:00 AM', '9:00 AM', '10:00 AM', '11:00 AM', '12:00 PM', '1:00 PM', '2:00 PM', '3:00 PM'];
                
                times.forEach(t => {
                    // Randomly disable some
                    const disabled = Math.random() > 0.7 ? 'disabled' : '';
                    html += `<div class="time-btn ${disabled}" onclick="this.classList.toggle('selected')">${t}</div>`;
                });
                container.innerHTML = html;
            }
        }

        // Initialize App
        const app = new CalendarApp();

    </script>
</body>
</html>
